<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <title>webIM</title>
    <!-- Bootstrap.css -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css"/>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="assets/css/index.css"/>
</head>

<body>
<!-- 登录页面 -->
<div class="fpage center hide" id="loginPage">
    <h2>客户登录</h2>
    <input type="text" id="user" value placeholder="请输入账号"/><br/>
    <input type="text" id="pwd" value placeholder="请输入密码"/><br/>
    <button id="login">登录</button>
    <p style="text-align: right; letter-spacing: 1px"><span></span> <i id="toregister" msg="">忘记密码？</i></p>
</div>
<!-- 主界面 -->
<!--<div class="main hide">-->
<div class="main hide" id="main">
    <div class="main-inner">
        <div class="chat-box" style="top: 50%; position: unset; left:0; margin-top: 5%">
            <div class="header">
                <div class="head-portrait"><img src="assets/img/tx.jpg" alt="" width="40px" height="40px"></div>
                <div class="info" style="width: 900px">
                    <span class="nikename" style="color: #000">鼎健医学</span>
                </div>
                <div class="info" style="width: 100px !important; cursor: pointer">
                    <span id="repwd" class="mody-pwd">修改密码</span>
                </div>
                <div class="info" style="width: 100px !important; cursor: pointer">
                    <span id="logout">退出登录</span>
                </div>
            </div>
            <div id="chat-box-content">
                <div id="ChatRosters-123" class="chat-box-content"></div>
            </div>
            <div class="chat-box-input">
                <div class="tool-bar">
                    <a class="face " href="javascript:;">
                        <ul class="hide">
                            <li key="[:D]"><img src="assets/img/face/ee_1.png" alt="表情1"></li>
                            <li><img src="assets/img/face/ee_2.png" alt="表情2"></li>
                            <li><img src="assets/img/face/ee_3.png" alt="表情3"></li>
                            <li><img src="assets/img/face/ee_4.png" alt="表情4"></li>
                            <li><img src="assets/img/face/ee_5.png" alt="表情5"></li>
                            <li><img src="assets/img/face/ee_6.png" alt="表情6"></li>
                            <li><img src="assets/img/face/ee_7.png" alt="表情7"></li>
                            <li><img src="assets/img/face/ee_8.png" alt="表情8"></li>
                            <li><img src="assets/img/face/ee_9.png" alt="表情9"></li>
                            <li><img src="assets/img/face/ee_10.png" alt="表情10"></li>
                            <li><img src="assets/img/face/ee_11.png" alt="表情11"></li>
                            <li><img src="assets/img/face/ee_12.png" alt="表情12"></li>
                            <li><img src="assets/img/face/ee_13.png" alt="表情13"></li>
                            <li><img src="assets/img/face/ee_14.png" alt="表情14"></li>
                            <li><img src="assets/img/face/ee_15.png" alt="表情15"></li>
                            <li><img src="assets/img/face/ee_16.png" alt="表情16"></li>
                            <li><img src="assets/img/face/ee_17.png" alt="表情17"></li>
                            <li><img src="assets/img/face/ee_18.png" alt="表情18"></li>
                            <li><img src="assets/img/face/ee_19.png" alt="表情19"></li>
                            <li><img src="assets/img/face/ee_20.png" alt="表情20"></li>
                            <li><img src="assets/img/face/ee_21.png" alt="表情21"></li>
                            <li><img src="assets/img/face/ee_22.png" alt="表情22"></li>
                            <li><img src="assets/img/face/ee_23.png" alt="表情23"></li>
                            <li><img src="assets/img/face/ee_24.png" alt="表情24"></li>
                            <li><img src="assets/img/face/ee_25.png" alt="表情25"></li>
                            <li><img src="assets/img/face/ee_26.png" alt="表情26"></li>
                            <li><img src="assets/img/face/ee_27.png" alt="表情27"></li>
                            <li><img src="assets/img/face/ee_28.png" alt="表情28"></li>
                            <li><img src="assets/img/face/ee_29.png" alt="表情29"></li>
                            <li><img src="assets/img/face/ee_30.png" alt="表情30"></li>
                            <li><img src="assets/img/face/ee_31.png" alt="表情31"></li>
                            <li><img src="assets/img/face/ee_32.png" alt="表情32"></li>
                            <li><img src="assets/img/face/ee_33.png" alt="表情33"></li>
                            <li><img src="assets/img/face/ee_34.png" alt="表情34"></li>
                            <li><img src="assets/img/face/ee_35.png" alt="表情35"></li>
                        </ul>
                    </a>
                    <a class="file" href="javascript:;">
                        <input type="file" accept="image/png,image/gif,image/jpeg" id="file"> </a>
                </div>
                <div class="text" id="text" contenteditable="true"></div>
                <div class="action"><span>按下Ctrl+Enter发送消息</span> <a id="send" href="javascript:;">发送</a></div>
            </div>
        </div>
    </div>
</div>

<!-- 重置密码 -->
<div class="dialog-box" id="dialog-box">
    <div class="input-group" style="margin-bottom: 10px">
        <span class="input-group-addon" style="width:100px">原密码</span>
        <input type="password" class="form-control" placeholder="请输入旧密码" name="oldPwd">
        <span class="input-group-addon">.00</span>
    </div>
    <div class="input-group" style="margin-bottom: 10px">
        <span class="input-group-addon" style="width:100px">新密码</span>
        <input type="password" class="form-control" placeholder="请输入新密码" maxlength="6" name="newPwd">
        <span class="input-group-addon">.00</span>
    </div>
    <div class="input-group" style="margin-bottom: 10px">
        <span class="input-group-addon" style="width:100px">重复新密码</span>
        <input type="password" class="form-control" placeholder="请再次输入新密码" maxlength="6" name="reNewPwd">
        <span class="input-group-addon">.00</span>
    </div>
    <div class="btn-group" style="margin-left:100px">
        <button type="button" class="btn bg-primary" style="margin-right: 15px" id="submitBtn">提交</button>
        <button type="button" class="btn btn-default" id="closeBtn">取消</button>
    </div>
</div>


<style>
    /* 下拉加载 */
    .load-end {
        color: #999;
        text-align: center;
        line-height: 400%
    }

    /* 重置密码 */
    .dialog-box {
        width: 330px;
        background-color: rgba(255, 255, 255, 0.5);
        border-radius: 10px;
        padding: 10px;
        position: absolute;
        top: 50%;
        left: 50%;
        margin-left: -165px;
        margin-top: -150px;
        border-radius: 10px;
        border: 5px solid rgba(30, 144, 255, 0.5);
        display: none;
    }

    .mody-pwd {
        padding: 5px 15px;
        background-color: #fff;
        border: 1px solid #ddd;
        display: block;
        position: relative;
        right: 10px
    }
</style>

<!-- 配置信息 -->
<script src="sdk/webim.config.js"></script>
<script src="sdk/strophe-1.2.8.min.js"></script>
<!-- webSdk -->
<script src="sdk/websdk-1.4.12.js"></script>
<!-- myJs -->
<script src="assets/js/index.js"></script>
<!-- jQuery -->
<script src="./assets//js/jquery.min.js"></script>
<!-- Bootstrap.js -->
<script src="assets/js/bootstrap.min.js"></script>
<script src="https://cdn.bootcss.com/layer/2.3/layer.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        var page = 2;
        var isLoad = false;
        $("#ChatRosters-123").unbind("scroll").bind("scroll", function (e) {
            if (isLoad) {
                return false;
            }
            if ($(this).scrollTop() < 20) {
                var apiName = 'http://www.dj.com/api.php?s=';
                var dataObj = {"token": customer.token, "page": page};
                $.ajax({
                    type: 'POST',
                    url: apiName + 'message/index/messageList',
                    data: dataObj,
                    async: false,
                    success: function (res) {
                        if (res.data.length < 10) {
                            isLoad = true;
                            $('#ChatRosters-123').prepend('<div class="load-end">———— 我是有底线的 ————</div>');
                            return false;
                        }

                        var html = '';
                        for (var i = 0; i < res.data.length; i++) {
                            //客服
                            if (res.data[i].user_type === 1) {
                                html += '<div class="otherMsg"><img src="https://wx-demo-api.jc001.cn/images/agent/head1.jpg" width="40px" height="40px" id="limg">' +
                                    '<h4>鼎健在线客服</h4>\n' +
                                    '<span>' + res.data[i].content + '</span></div>';
                            }
                            //客户
                            if (res.data[i].user_type === 2) {
                                html += '<div class="myMsg">' +
                                    '<img src="' + customer.avatar + '" width="40px" height="40px" id="rimg">' +
                                    '<h4>' + customer.nickname + '</h4>\n' +
                                    '<span>' + res.data[i].content + '</span>\n' +
                                    '</div>';
                            }
                        }
                        $('#ChatRosters-123').prepend(html);
                        page++;
                    }
                });
            }
        });
    });
</script>
</body>
</html>
